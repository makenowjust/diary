{"componentChunkName":"component---src-templates-post-js","path":"/post/2020-08-08-diary/","result":{"data":{"site":{"siteMetadata":{"title":"℘ make now just"}},"markdownRemark":{"html":"<h1>やったこと</h1>\n<h2>シャニ</h2>\n<p>社長の夏休みの宿題その2、R編成でGRAD優勝をやった。<br>\nこっちはとくに難しくなかった。やっぱR編成でTrueの難易度がおかしい。</p>\n<p><a href=\"https://twitter.com/make_now_just/status/1291990170212773891\" class=\"embedly-card\">https://twitter.com/make_now_just/status/1291990170212773891</a></p>\n<h2>diary</h2>\n<p>ヘッダーのバーが表示されていなかったのが気になった。<br>\ncssnanoのバグで、<code>%</code> 表記のopacityが<code>1%</code>にされてしまってるからっぽい。</p>\n<p><a href=\"https://github.com/cssnano/cssnano/issues/892\" class=\"embedly-card\">https://github.com/cssnano/cssnano/issues/892</a></p>\n<p>とりあえず<code>0.x</code>表記にすることで解決した。<br>\ncssnanoのメンテナが足りてないのか新バージョンがリリースされてない‥‥。</p>\n<p>あとservice workerいらない気がしたので削除した。<br>\nこの決断に何年かけたんだ‥‥。</p>\n<p>そろそろこのdiaryも作り直すべきなのかねえ(式年遷宮)。</p>\n<h2>Scala</h2>\n<p>昨日やっていたfastparseもどき、miniparseをプロファイルとって最適化してみた。<br>\n<code>.rep</code>の結果として<code>Seq</code>を作るところと、予期していたトークンを保持する<code>Buffer</code>の確保と、予期していたトークン名の生成が問題になっていたので、その辺りを最適化してみた。</p>\n<pre><code>[info] Benchmark                        Mode  Cnt     Score      Error  Units\n[info] Bench.measureAtto               thrpt    3    85.396 ±   21.794  ops/s\n[info] Bench.measureFastparse          thrpt    3  2853.266 ±  557.498  ops/s\n[info] Bench.measureMiniparse          thrpt    3  2861.233 ±  655.351  ops/s\n[info] Bench.measureParserCombinators  thrpt    3   287.327 ± 1249.551  ops/s\n</code></pre>\n<p>fastparseと同じくらいになったのでいい感じ。<br>\nただ、エラーメッセージが不親切になってしまったので、予期していたトークン名を生成する部分だけマクロにした方がいいようだ。</p>\n<p>プロファイルは<a href=\"https://github.com/jvm-profiling-tools/async-profiler\">async-profiler</a>を使った。<br>\nフレームグラフが簡単に出力できて便利だった。<br>\n使い方は簡単で、<code>jsp</code>でプロファイルを取る対象のJVMプロセスを調べて、次のようにする。</p>\n<pre><code class=\"hljs language-console\"><span class=\"hljs-meta prompt_\">$ </span><span class=\"bash\">./profile.sh -d 30 -f flamegraph.svg &#x3C;プロセス番号></span></code></pre>\n<p><code>-d</code>のあとの数字は測定する秒数で、このコマンドで<code>flamegraph.svg</code>が生成される。</p>\n<p>これはこれで楽しいけどそろそろ諸々をやっていかなければ‥‥。</p>","fields":{"date":"2020-08-08"},"frontmatter":{"title":"天井社長の夏の宿題2つ目"},"excerpt":"やったこと シャニ 社長の夏休みの宿題その2、R編成でGRAD優勝をやった。 こっちはとくに難しくなかった。やっぱR編成でTrueの難易度がおかしい。 https://twitter.com/make_now_just/status/1291990170212773891 di…"},"prev":{"fields":{"date":"2020-08-09","slug":"/post/2020-08-09-diary/"},"frontmatter":{"title":"Shards 0.12のリリース記事を翻訳した"}},"next":{"fields":{"date":"2020-08-07","slug":"/post/2020-08-07-diary/"},"frontmatter":{"title":"fastparseもどきを作っている"}}},"pageContext":{"slug":"/post/2020-08-08-diary/","prevSlug":"/post/2020-08-09-diary/","nextSlug":"/post/2020-08-07-diary/"}},"staticQueryHashes":["1213933803","2548877431"],"slicesMap":{}}